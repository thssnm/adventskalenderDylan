import Head from 'next/head'
import Image from 'next/image'
import styles from '../styles/Home.module.css'
import { numbers } from './numbers'
import React from 'react'

const Overlay = ({ item, visible, setVisible }) => {
  if (!visible) {
    return null
  }
  return <div onClick={() => setVisible(false)} style={{
    backgroundColor: "rgba(0,0,0,0.8)",
    position: "absolute",
    top: 0,
    left: 0,
    right: 0,
    bottom: 0,
    display: "flex",
    justifyContent: "center",
    alignItems: "center"
  }}
  >
    <div style={{ width: 300, height: 300, backgroundColor: "white", borderRadius: 12 }}>
      <h2 style={{ color: "black" }}>{item.number + ". " + item.title}</h2>
      <p style={{ color: "black" }}>{item.text}</p>
    </div>
  </div>
}

const CalendarItem = ({ item }: {
  item: {
    number: string;
    title: string;
    text: string;
    uri: string;
  }
}) => {

  //window.localStorage() bitmaske
  const [visible, setVisible] = React.useState(false)
  /*   let opened: string[] = undefined
    if (typeof window !== "undefined") {
      opened = JSON.parse(window?.localStorage["opened"])
    } */

  const onPressItem = () => {
    if (Number(item.number) <= new Date().getDate()) {
      setVisible(!visible)
      //window.localStorage["opened"] = JSON.stringify([...JSON.parse(window.localStorage["opened"] || "[]"), item.number])
    }
  }

  //let opened: string[] =   window?.localStorage["opened"] && JSON.parse(window?.localStorage["opened"])

  const style = Number(item.number) <= new Date().getDate() ? "green" : "red"
  return <>
    <div onClick={onPressItem} style={{
      width: 100,
      height: 100,
      margin: 12,
      display: "flex",
      alignItems: "center",
      backgroundColor: style, //opened?.includes(item.number) ? "yellow" : "green",
      justifyContent: "center",
      borderRadius: 12,
    }} >
      <h2 >{item.number}</h2>
    </div>
    {/* <Snowfall /> */}
    <Overlay visible={visible} item={item} setVisible={setVisible} />
  </>
}



export default function Home() {

  return (
    <div className={styles.container}>
      <Head>
        <title> App</title>
        <meta name="description" content="Generated by create next app" />
        <link rel="icon" href="/favicon.ico" />
      </Head>
      <main className={styles.main}>
        <div style={{ flexDirection: "row", display: "flex", flexWrap: "wrap", maxWidth: 500 }}>
          {numbers.map((item) => {
            return <CalendarItem key={item.number} item={item} />
          })}
        </div>
      </main>
    </div>
  )
}
